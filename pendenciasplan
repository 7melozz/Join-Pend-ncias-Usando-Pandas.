import pandas as pd
df_principal = pd.read_excel("/content/PendenciasQualicard.xlsx", engine="openpyxl")
#planilha primaria
df_status = pd.read_csv("/content/esteira (24).csv", sep=";", encoding="latin1")
#planilha com status, utilizei latin1 para converter as letras.

df_principal_filtrada = principal[[
    "Nr Proposta",
    "Convênio",
    "Nome",
    "CPF",
    "Atividade"
]]
#colunas principais para analise e acoplagem

df_status_filtrada = status[[
    "ADE",
    "Status",
    "Agente"
]]
#levando essa para principal, para que possamos converter em outra planilha

principal_filtrada["Nr Proposta"] = principal_filtrada["Nr Proposta"].astype(str)
#filtrando por "Nr proposta" e convertendo para string utilizando como meio de comparação.
status_filtrada["ADE"] = status_filtrada["ADE"].astype(str)
#filtrando por "ADE" e convertendo para string utilizando como meio de comparação.

status_filtrada = status_filtrada.rename(columns={"ADE": "Nr Proposta"})
#criei e alterei o nome da coluna

resultado = principal_filtrada.merge(status_filtrada, on="Nr Proposta", how="left")

resultado.to_excel("resultado_final.xlsx", index=False)
